class t{static Status={IDLE:"idle",PLAYING:"playing",WIN:"win",LOSE:"lose"};static Config={ROWS:4,COLUMNS:4};constructor(e){this.state=e,this.score=0,this.status=t.Status.IDLE}renderBoard(){document.querySelector(".game-field").innerHTML="";for(let e=0;e<t.Config.ROWS;e++)for(let s=0;s<t.Config.COLUMNS;s++){let t=document.createElement("div");t.id=`${e}-${s}`;let i=this.state[e][s];this.updateTile(t,i),document.querySelector(".game-field").append(t)}}addRandomTile(){let e=[];for(let s=0;s<t.Config.ROWS;s++)for(let i=0;i<t.Config.COLUMNS;i++)0===this.state[s][i]&&e.push({row:s,col:i});if(e.length>0){let t=e[Math.floor(Math.random()*e.length)];this.state[t.row][t.col]=.9>Math.random()?2:4}}filterZero(t){return t.filter(t=>0!==t)}slide(e){let s=this.filterZero(e);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,s[t+1]=0,this.score+=s[t]);for(s=this.filterZero(s);s.length<t.Config.ROWS;)s.push(0);return s}updateTile(t,e){t.innerText="",t.classList.value="",t.classList.add("field-cell"),e>0&&(t.innerText=e,t.classList.add(`field-cell--${e}`))}moveLeft(){for(let e=0;e<t.Config.ROWS;e++){let s=this.state[e];s=this.slide(s),this.state[e]=s;for(let s=0;s<t.Config.COLUMNS;s++){let t=document.getElementById(e.toString()+"-"+s.toString()),i=this.state[e][s];this.updateTile(t,i)}}}moveRight(){for(let e=0;e<t.Config.ROWS;e++){let s=this.state[e];s.reverse(),(s=this.slide(s)).reverse(),this.state[e]=s;for(let s=0;s<t.Config.COLUMNS;s++){let t=document.getElementById(e.toString()+"-"+s.toString()),i=this.state[e][s];this.updateTile(t,i)}}}moveUp(){for(let e=0;e<t.Config.COLUMNS;e++){let s=[this.state[0][e],this.state[1][e],this.state[2][e],this.state[3][e]];s=this.slide(s);for(let i=0;i<t.Config.ROWS;i++){this.state[i][e]=s[i];let t=document.getElementById(i.toString()+"-"+e.toString()),r=this.state[i][e];this.updateTile(t,r)}}}moveDown(){for(let e=0;e<t.Config.COLUMNS;e++){let s=[this.state[0][e],this.state[1][e],this.state[2][e],this.state[3][e]];s.reverse(),(s=this.slide(s)).reverse();for(let i=0;i<t.Config.ROWS;i++){this.state[i][e]=s[i];let t=document.getElementById(i.toString()+"-"+e.toString()),r=this.state[i][e];this.updateTile(t,r)}}}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}start(){this.status=t.Status.PLAYING,this.addRandomTile(),this.addRandomTile()}restart(){this.status=t.Status.PLAYING,this.state=this.state.map(t=>t.map(()=>0)),this.score=0,this.start()}hasPossibleMoves(){let e=t.Config.ROWS,s=t.Config.COLUMNS;for(let t=0;t<e;t++)for(let i=0;i<s;i++){let r=this.state[t][i];if(0===r)return!0;let a=i+1<s?this.state[t][i+1]:null,o=t+1<e?this.state[t+1][i]:null,l=i-1>=0?this.state[t][i-1]:null,n=t-1>=0?this.state[t-1][i]:null;if(r===a||r===o||r===l||r===n)return!0}return!1}isMoveMade(e){for(let s=0;s<t.Config.ROWS;s++)for(let i=0;i<t.Config.COLUMNS;i++)if(e[s][i]!==this.state[s][i])return!0;return!1}hasEmptyTile(){return this.state.some(t=>t.includes(0))}checkGameOver(){this.hasEmptyTile()||this.hasPossibleMoves()?this.state.some(t=>t.includes(2048))&&(this.status=t.Status.WIN):this.status=t.Status.LOSE}}const e=new t([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]);e.renderBoard();const s=document.querySelector(".start"),i=document.querySelector(".game-score");function r(e){e===t.Status.PLAYING?(document.querySelector(".message-start").classList.add("hidden"),document.querySelector(".message-lose").classList.add("hidden")):e===t.Status.LOSE?document.querySelector(".message-lose").classList.remove("hidden"):e===t.Status.WIN&&document.querySelector(".message-win").classList.remove("hidden")}s.addEventListener("click",()=>{e.getStatus()===t.Status.IDLE?(s.classList.value="",s.classList.add("button","restart"),s.innerText="Restart",e.start(),e.renderBoard(e.state)):(e.status===t.Status.PLAYING||e.status===t.Status.LOSE)&&(e.restart(),i.innerText=0,r(e.status),e.renderBoard(e.state))}),document.addEventListener("keydown",s=>{if(e.status===t.Status.PLAYING){let t=JSON.parse(JSON.stringify(e.state));switch(s.key){case"ArrowLeft":e.moveLeft();break;case"ArrowRight":e.moveRight();break;case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown();break;default:return}e.isMoveMade(t)&&(e.checkGameOver(),e.addRandomTile(),e.checkGameOver(),r(e.status),e.renderBoard(e.state),i.innerText=e.score)}});
//# sourceMappingURL=index.7ca85bd6.js.map
